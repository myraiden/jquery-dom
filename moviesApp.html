<!--BEGIN ASSIGNMENT DESCRIPTION
## **Part Two - Movies App!**
Build an application that uses jQuery to do the following:
- Contains a form with two inputs for a title and rating along with a button to submit the form.
- When the form is submitted, capture the values for each of the inputs and append them to the DOM along with a button to remove each title and rating from the DOM.
- When the button to remove is clicked, remove each title and rating from the DOM.

## **Further Study**
- Ensure that the rating of a movie can only be between 0 and 10.
- Ensure that a title has at least 2 characters in it.
- Allow users to sort alphabetically by the title of the movie or by the rating of the movie from lowest to highest and vice versa.

END ASSIGNMENT DESCRIPTION-->

 <!DOCTYPE html>
 <html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movies App</title>
    <link rel="stylesheet"
    href="https://unpkg.com/bootstrap/dist/css/bootstrap.css">
    <style>
        /* format that beautiful form */
        /* NOTE: Student is formatting this here because that is how the first exercise did it. 
                   Student acknowledges a *.CSS file would be make the *.HTML file easier to read. */
        /*create a container that will resize with the window*/
        .container{
            float: left;
            display: grid;
            grid-template-columns: 300px auto ;
        }
        /*left column with styling, this is the user entry*/
        .left{
            height: fit-content;
            padding-left: 20px;
            border-radius: 5px;
            border-style:ridge;
        }
        /*right column with styling, this displays the movies entered by the user*/
        .right{
            margin-left: 20px;
        }
        /*style the user movieName input*/
        input[type="text"]{
            width: 95%;
        }
        /*style the MPR rating selection*/
        .divRating{
            padding-block: 10px;
        }

        input[type="radio"]{
            margin-inline: 4%
            
        }
        /*style the submission button*/
        .divSubmit{
            display: flex;
            justify-content: center;
            padding-bottom: 10px;
        }
        /*style the user score values*/
        .viewerScore{
            padding-bottom: 15px;
        }
        /*this is a tooltip to tell the user how the scoring works*/
        .scoreHint{
            visibility: hidden;
            display: inline-block;
            margin-inline: 15%;
        }
        
        .viewerScore:hover .scoreHint{
            visibility: visible;
        }

        .viewerscore .scoreHint{
            top: -5px;
            left: 105%;
        }
        /*style the table where the user submitted movies are entered*/
        .movieTable{
            border-style: solid;
            column-rule-style: solid;
        }

        th, td{
            border: 1px solid;
            padding-inline: 5px;
        }
    
      </style>
 </head>
 <body>

        <div class="container">
            <div class="column left">
                <form class="movieForm">
                    <div class="divName" >
                        Enter Name of Movie:
                        <input type="text" name="movieName" placeholder="Movie Title">
                    </div>
                    <!-- NOTE: Student initially misunderstood the intent of the word "rating" and originally interpreted it as "MPR rating".
                                Student elected to leave this part of the form in the assignment since it compliments the intent of the exercise.-->
                    <div class="divRating">
                        <input type="radio" name="movieRating" id="G" value="G" checked="true"><label for="G">G</label>
                        <input type="radio" name="movieRating" id="PG" value="PG"><label for="PG">PG</label>
                        <input type="radio" name="movieRating" id="PG13" value="PG13"><label for="PG13">PG-13</label>
                        <input type="radio" name="movieRating" id="R" value="R"><label for="R">R</label>
                    </div>

                    <div class="viewerScore">
                        Score Move out of 10:
                        <input type="number" name="finalScore" min="0" max="10" id="finalScore" value="5">
                        <span class="scoreHint">10 is best, 0 is worst</span>
                    </div>
                    <div class="divSubmit">
                        <button type="submit" class="submitForm">Submit Form</button>
                    </div>

                </form>
            </div>
            <div class="column right">
                <table class="movieTable">
                    <thead>
                    <tr>
                        <th>Movie Name</th><th>MPA Rating</th><th>Viewer Score</th>
                    </tr>
                </thead>
                <tbody></tbody>
                </table>
            </div>
        </div>

    </body>

 <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
 <script>
 //add jquery stuff here
 //create an object for the saving of movie names and a counter for giving unique IDs to each movie
 let $allMovies={}
 let $movieCount=0
 
 //create a class for user submission of movies
 class $userSubmission{
    constructor(movieName,movieRating,finalScore) {
        this.movieName=movieName;
        this.movieRating=movieRating;
        this.finalScore=finalScore
    }
 }

 //handle the form when a user clicks submit
 $(".submitForm").on("click", (e)=>{
    //prevent page from refreshing upon submit
    e.preventDefault()

    //require that the movieName input has at least two characters
    console.log($(`input[name="movieName"]`))
    if( $(`input[name="movieName"]`).val().length>=2){
        //capture the values
        const $newMovie = new $userSubmission($(`input[name="movieName"]`).val(), $(`input[name="movieRating"]:checked`).val(), $(`input[name="finalScore"]`).val())

        //reset all your fields
        $(".movieForm").trigger("reset");
        
        //check how many movies have been added
        //  this increments so each new entry has a unique key regardless of whether an entry is deleted
        if(Object.keys($allMovies)!=0){
            $movieCount=$movieCount+1
        }
        //pass values to the object
        Object.assign($allMovies, {['movie'+$movieCount]: $newMovie})
 
        //generate table using the entire movie list
        refreshMovies()
    }
    //otherwise alert the user movieName is too short
    else{
        alert("Movie name must be 2 characters or greater.")
    }
 })

 //refresh the listed movies using the $allMovies Object
 function refreshMovies(){
    //clear the table but leave the header
    $(".movieTable tr td").remove()

    //generate the new table values and include a delete button that calls the remove function
    let $newTable=""
    Object.entries($allMovies).map((movieNumber)=>{
            $newTable+=`<tr id="${movieNumber[0]}"><td>${movieNumber[1].movieName}</td><td>${movieNumber[1].movieRating}</td><td>${movieNumber[1].finalScore}</td><td><button class="removeMovie" onclick="reMovie();">Remove</button></td></tr>`
    })
    //append new table to the header
    $(".movieTable").append($newTable)
    
 }

 //this function allows the user to delete the value from the object
 //     this function also calls the refreshMovies function to update the table
 function reMovie() {
    //get the id from the row the user clicked on
    let $deleteRow=$(':focus').closest("tr").attr("id")
    delete $allMovies[$deleteRow]
    refreshMovies()
 }

 //Allow users to sort alphabetically by the title of the movie or by the rating of the movie from lowest to highest and vice versa.
 // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object
 // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/groupBy
 function sortMovies(sortType){
    /*sortType will allow for:
        movieName Sort Alphabetically
            UP: A-Z+nums
            DOWN: nums+Z-A
        finalScore Sort by user rating:
            UP: 0-10
            DOWN: 10-0
        OPTIONAL: Sort by MPR rating? (this might be the simplest sort because we use "groupBy" on the movieRating category)
            UP: G, PG, PG13, R
            DOWN: R, PG13, PG, G

    */
    //will need to make a new OBJECT to house the resorted items
    let $sortedMovies={}
    
    /*EXAMPLES:
    ES8:
    const sortable = Object.entries(maxSpeed)
        .sort(([,a],[,b]) => a-b)
        .reduce((r, [k, v]) => ({ ...r, [k]: v }), {});
    console.log(sortable);

    ES10
    const sortable = Object.fromEntries(
        Object.entries(maxSpeed).sort(([,a],[,b]) => a-b)
    );
    console.log(sortable);

    SOURCE:
    https://stackoverflow.com/questions/1069666/sorting-object-property-by-values
    */

    //Pass $sortedMovies back to $userSubmissions at the end and call refreshMovies()
    delete $allMovies
    Object.assign($allMovies, $sortedMovies)
    refreshMovies()
 }

 </script>
 </body>
 </html>

